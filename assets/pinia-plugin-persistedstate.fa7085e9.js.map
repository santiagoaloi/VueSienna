{"version":3,"file":"pinia-plugin-persistedstate.fa7085e9.js","sources":["../../node_modules/pinia-plugin-persistedstate/dist/chunk-256H5QT7.mjs","../../node_modules/pinia-plugin-persistedstate/dist/index.mjs"],"sourcesContent":["var __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\n\n// src/core/normalize.ts\nfunction isObject(v) {\n  return typeof v === \"object\" && v !== null;\n}\nfunction identity(v) {\n  return v;\n}\nfunction normalizeOptions(options, factoryOptions) {\n  options = isObject(options) ? options : /* @__PURE__ */ Object.create(null);\n  return new Proxy(options, {\n    get(target, key, receiver) {\n      var _a;\n      if (key === \"key\") {\n        return ((_a = factoryOptions.key) != null ? _a : identity)(\n          Reflect.get(target, key, receiver)\n        );\n      }\n      return Reflect.get(target, key, receiver) || Reflect.get(factoryOptions, key, receiver);\n    }\n  });\n}\n\n// src/core/pick.ts\nfunction isObject2(value) {\n  return value !== null && typeof value === \"object\";\n}\nfunction merge(destination, source) {\n  const mergingArrays = Array.isArray(destination) && Array.isArray(source);\n  const mergingObjects = isObject2(destination) && isObject2(source);\n  if (!mergingArrays && !mergingObjects) {\n    throw new Error(\"Can only merge object with object or array with array\");\n  }\n  const result = mergingArrays ? [] : {};\n  const keys = [...Object.keys(destination), ...Object.keys(source)];\n  keys.forEach((key) => {\n    if (Array.isArray(destination[key]) && Array.isArray(source[key])) {\n      result[key] = [\n        ...Object.values(\n          merge(destination[key], source[key])\n        )\n      ];\n    } else if (source[key] !== null && typeof source[key] === \"object\" && typeof destination[key] === \"object\") {\n      result[key] = merge(\n        destination[key],\n        source[key]\n      );\n    } else if (destination[key] !== void 0 && source[key] === void 0) {\n      result[key] = destination[key];\n    } else if (destination[key] === void 0 && source[key] !== void 0) {\n      result[key] = source[key];\n    }\n  });\n  return result;\n}\nfunction get(state, path) {\n  return path.reduce((obj, p) => {\n    if (p === \"[]\" && Array.isArray(obj))\n      return obj;\n    return obj == null ? void 0 : obj[p];\n  }, state);\n}\nfunction set(state, path, val) {\n  const modifiedState = path.slice(0, -1).reduce((obj, p) => {\n    if (!/^(__proto__)$/.test(p))\n      return obj[p] = obj[p] || {};\n    else\n      return {};\n  }, state);\n  if (Array.isArray(modifiedState[path[path.length - 1]]) && Array.isArray(val)) {\n    const merged = modifiedState[path[path.length - 1]].map(\n      (item, index) => {\n        if (Array.isArray(item) && typeof item !== \"object\") {\n          return [...item, ...val[index]];\n        }\n        if (typeof item === \"object\" && item !== null && Object.keys(item).some((key) => Array.isArray(item[key]))) {\n          return merge(item, val[index]);\n        }\n        return __spreadValues(__spreadValues({}, item), val[index]);\n      }\n    );\n    modifiedState[path[path.length - 1]] = merged;\n  } else if (path[path.length - 1] === void 0 && Array.isArray(modifiedState) && Array.isArray(val)) {\n    modifiedState.push(...val);\n  } else {\n    modifiedState[path[path.length - 1]] = val;\n  }\n  return state;\n}\nfunction pick(baseState, paths) {\n  return paths.reduce(\n    (substate, path) => {\n      const pathArray = path.split(\".\");\n      if (!pathArray.includes(\"[]\")) {\n        return set(substate, pathArray, get(baseState, pathArray));\n      }\n      const arrayIndex = pathArray.indexOf(\"[]\");\n      const pathArrayBeforeArray = pathArray.slice(0, arrayIndex);\n      const pathArrayUntilArray = pathArray.slice(0, arrayIndex + 1);\n      const pathArrayAfterArray = pathArray.slice(arrayIndex + 1);\n      const referencedArray = get(\n        baseState,\n        pathArrayUntilArray\n      );\n      const referencedArraySubstate = [];\n      for (const item of referencedArray) {\n        if (pathArrayAfterArray.length !== 0 && (Array.isArray(item) || typeof item === \"object\")) {\n          referencedArraySubstate.push(\n            pick(item, [pathArrayAfterArray.join(\".\")])\n          );\n        } else {\n          referencedArraySubstate.push(item);\n        }\n      }\n      return set(substate, pathArrayBeforeArray, referencedArraySubstate);\n    },\n    Array.isArray(baseState) ? [] : {}\n  );\n}\n\n// src/core/plugin.ts\nfunction hydrateStore(store, storage, serializer, key, debug) {\n  try {\n    const fromStorage = storage == null ? void 0 : storage.getItem(key);\n    if (fromStorage)\n      store.$patch(serializer == null ? void 0 : serializer.deserialize(fromStorage));\n  } catch (error) {\n    if (debug)\n      console.error(error);\n  }\n}\nfunction createPersistedState(factoryOptions = {}) {\n  return (context) => {\n    const {\n      options: { persist },\n      store\n    } = context;\n    if (!persist)\n      return;\n    const persistences = (Array.isArray(persist) ? persist.map((p) => normalizeOptions(p, factoryOptions)) : [normalizeOptions(persist, factoryOptions)]).map(\n      ({\n        storage = localStorage,\n        beforeRestore = null,\n        afterRestore = null,\n        serializer = {\n          serialize: JSON.stringify,\n          deserialize: JSON.parse\n        },\n        key = store.$id,\n        paths = null,\n        debug = false\n      }) => ({\n        storage,\n        beforeRestore,\n        afterRestore,\n        serializer,\n        key,\n        paths,\n        debug\n      })\n    );\n    persistences.forEach((persistence) => {\n      const {\n        storage,\n        serializer,\n        key,\n        paths,\n        beforeRestore,\n        afterRestore,\n        debug\n      } = persistence;\n      beforeRestore == null ? void 0 : beforeRestore(context);\n      hydrateStore(store, storage, serializer, key, debug);\n      afterRestore == null ? void 0 : afterRestore(context);\n      store.$subscribe(\n        (_mutation, state) => {\n          try {\n            const toStore = Array.isArray(paths) ? pick(state, paths) : state;\n            storage.setItem(key, serializer.serialize(toStore));\n          } catch (error) {\n            if (debug)\n              console.error(error);\n          }\n        },\n        {\n          detached: true\n        }\n      );\n    });\n    store.$hydrate = ({ runHooks = true } = {}) => {\n      persistences.forEach((persistence) => {\n        const { beforeRestore, afterRestore, storage, serializer, key, debug } = persistence;\n        if (runHooks)\n          beforeRestore == null ? void 0 : beforeRestore(context);\n        hydrateStore(store, storage, serializer, key, debug);\n        if (runHooks)\n          afterRestore == null ? void 0 : afterRestore(context);\n      });\n    };\n  };\n}\n\nexport {\n  __spreadValues,\n  createPersistedState\n};\n","import {\n  createPersistedState\n} from \"./chunk-256H5QT7.mjs\";\n\n// src/index.ts\nvar src_default = createPersistedState();\nexport {\n  createPersistedState,\n  src_default as default\n};\n"],"names":["__defProp","__getOwnPropSymbols","__hasOwnProp","__propIsEnum","__defNormalProp","obj","key","value","__spreadValues","a","b","prop","isObject","v","identity","normalizeOptions","options","factoryOptions","target","receiver","_a","isObject2","merge","destination","source","mergingArrays","mergingObjects","result","get","state","path","p","set","val","modifiedState","merged","item","index","pick","baseState","paths","substate","pathArray","arrayIndex","pathArrayBeforeArray","pathArrayUntilArray","pathArrayAfterArray","referencedArray","referencedArraySubstate","hydrateStore","store","storage","serializer","debug","fromStorage","error","createPersistedState","context","persist","persistences","beforeRestore","afterRestore","persistence","_mutation","toStore","runHooks","src_default"],"mappings":"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"}